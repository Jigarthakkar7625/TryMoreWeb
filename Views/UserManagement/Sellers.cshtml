@model List<TryMoreWeb.Models.UsersModel>
@{
    ViewBag.Title = "Sellers";
    Layout = "~/Views/Shared/_Layout.cshtml";
}




<!-- ============================================================== -->
<!-- main wrapper -->
<!-- ============================================================== -->
<!-- ============================================================== -->
<!-- navbar -->
<!-- ============================================================== -->
<!-- ============================================================== -->
<!-- end navbar -->
<!-- ============================================================== -->
<!-- ============================================================== -->
<!-- left sidebar -->
<!-- ============================================================== -->
<!-- ============================================================== -->
<!-- end left sidebar -->
<!-- ============================================================== -->
<!-- ============================================================== -->
<!-- wrapper  -->
<!-- ============================================================== -->
<!-- ============================================================== -->
<!-- pageheader -->
<!-- ============================================================== -->
<div class="row">
    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
        <div class="page-header">
            <h2 class="pageheader-title">Sellers</h2>

        </div>
    </div>
</div>
<!-- ============================================================== -->
<!-- end pageheader -->
<!-- ============================================================== -->
<div class="row">
    <!-- ============================================================== -->
    <!-- basic table  -->
    <!-- ============================================================== -->
    <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12">
        <div class="card">
            <div class="card-header" style="text-align:right;">
                <div class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-12 ">
                    <button class="btn btn-primary" id="uploadFile" title="Upload excel file"> <i class="fas fa-upload"></i> </button>
                    <input type="file" style="display:none;" id="files" name="files" onchange="checkFile()" data-parsley-type="file" />
                </div>
            </div>
            @*<h5 class="card-header">Basic Table</h5>*@
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered first">
                        <thead>
                            <tr>
                                <th>User Name</th>
                                <th>First Name</th>
                                <th>Last Name</th>
                                <th>Email</th>
                                <th>Phone</th>
                                <th>Is Approve</th>
                            </tr>
                        </thead>
                        <tbody>
                            @{int index = 1;}
                            @if (Model.Count > 0)
                            {
                                foreach (var items in Model)
                                {
                                    <tr>
                                        <td>@items.UserName</td>
                                        <td>@items.FirstName</td>
                                        <td>@items.LastName</td>
                                        <td>@items.Email</td>
                                        <td>@items.Phone</td>
                                        <td>

                                            @if (items.Approve == 1)
                                            {
                                                <label class="custom-control custom-checkbox">
                                                    <input type="checkbox" id="chk_@items.UserID" onclick="SellerApprove(@items.UserID)" checked="checked" class="custom-control-input">
                                                    <span class="custom-control-label"></span>
                                                </label>
                                            }
                                            else
                                            {

                                                <label class="custom-control custom-checkbox">
                                                    <input type="checkbox" id="chk_@items.UserID" onclick="SellerApprove(@items.UserID)" class="custom-control-input">
                                                    <span class="custom-control-label"></span>
                                                </label>

                                            }


                                        </td>
                                    </tr>
                                }
                            }
                        </tbody>
                        @*<tfoot>
                        <tr>
                            <th>Name</th>
                            <th>Position</th>
                            <th>Office</th>
                            <th>Age</th>
                            <th>Start date</th>
                            <th>Salary</th>
                        </tr>
                    </tfoot>*@
                    </table>
                </div>
            </div>
        </div>
    </div>
    <!-- ============================================================== -->
    <!-- end basic table  -->
    <!-- ============================================================== -->
</div>
@*<a href="#" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">
        Launch demo modal
    </a>*@
<!-- Modal -->
@*<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
                    <a href="#" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </a>
                </div>
                <div class="modal-body">
                    <p>Woohoo, You are readng this text in a modal! Use Bootstrap’s JavaScript modal plugin to add dialogs to your site for lightboxes, user notifications, or completely custom content.</p>
                </div>
                <div class="modal-footer">
                    <a href="#" class="btn btn-secondary" data-dismiss="modal">Close</a>
                    <a href="#" class="btn btn-primary">Save changes</a>
                </div>
            </div>
        </div>
    </div>*@

<script type="text/javascript">
    function SellerApprove(items) {
        var r;
        var value;
        if ($("#chk_" + items).prop('checked')) {
            r = confirm("Are you sure you want to Approve this seller?");
            value = 1;
        }
        else {
            r = confirm("Are you sure you want to dis Approve this seller?");
            value = 0;
        }
        if (r == true) {
            var token = '@Session["access_token"].ToString()';

            $.ajax({
                url: '@ApiCollections.API_GET_SELLER_APPROVE' + "?userId=" + items + "&approve=" + value,
                type: 'POST',
                contentType: false,
                processData: false,
                beforeSend: function (xhr) {
                    xhr.setRequestHeader('Authorization', 'Bearer ' + token);
                },
                success: function (res) {
                    if (res.success) {
                        if (value == 1) {
                            bootoast.toast({
                                message: "Seller approve successfully.",
                                type: 'success',
                                position: 'right-top',
                            });
                        }
                        else {
                            bootoast.toast({
                                message: "Seller dis approve successfully.",
                                type: 'success',
                                position: 'right-top',
                            });
                        }

                    }

                },
                error: function (jqXHR, textStatus, errorThrown) {
                    bootoast.toast({
                        message: jqXHR.responseJSON.Message,
                        type: 'danger',
                        position: 'right-top',
                    });
                    return false;
                },
            });
        }
        else {
             $("#chk_" + items).prop('checked', !$("#chk_" + items).prop('checked'));
        }
    }

     $("#uploadFile").click(function myfunction() {
        $("#files").click();
    })

    function checkFile() {
        for (var i = 0; i < $("#files").get(0).files.length; ++i) {

                    var file1 = $("#files").get(0).files[i].name;

                    if (file1) {
                        //var file_size = $("#files").get(0).files[i].size;
                        //if (file_size < 2097152) {
                        var ext = file1.split('.').pop().toLowerCase();
                        if ($.inArray(ext, ['xlsx']) === -1) {
                            alert("Invalid file");
                            $("#files").val("");
                        }
                        else {
                             var fileUpload = $("#files").get(0);
                                var files = fileUpload.files;

                                // Create FormData object
                                var fileData = new FormData();

                                // Looping over all files and add it to FormData object
                                for (var i = 0; i < files.length; i++) {
                                    fileData.append(files[i].name, files[i]);
                                }
                            var token = '@Session["access_token"].ToString()';
                              $(".loader").show();
                                $.ajax({
                                    url: '@ApiCollections.API_USER_UPLOAD',
                                    type: "POST",
                                    contentType: false, // Not to set any content header
                                    processData: false, // Not to process data
                                    ajaxasync: true,
                                    data: fileData,
                                    beforeSend: function (xhr) {
                                            xhr.setRequestHeader('Authorization', 'Bearer ' + token);
                                    },
                                    success: function (res) {
                                        $(".loader").hide();
                                        if (res.success) {
                                            bootoast.toast({
                                                    message:res.message,
                                                    type: 'success',
                                                    position: 'right-top',
                                                });
                                        }
                                        else {
                                            bootoast.toast({
                                                    message:res.message,
                                                    type: 'danger',
                                                    position: 'right-top',
                                                });
                                        }
                                    },
                                    error: function (err) {
                                        $(".loader").hide();
                                        bootoast.toast({
                                            message: jqXHR.responseJSON.Message,
                                            type: 'danger',
                                            position: 'right-top',
                                        });
                                    }
                                });

                        }
                    }
                }
    }
</script>



<!-- ============================================================== -->
<!-- end main wrapper -->
<!-- ============================================================== -->
<!-- Optional JavaScript -->
